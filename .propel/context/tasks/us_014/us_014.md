# User Story - US_014

## Quick Reference Schema
```yaml
# User Story:
  * ID: [US_014]
  * Title: [Prevent concurrent sessions from same user]
## Description:
   * [As a security officer, I want to prevent concurrent sessions from the same user account, so that credential sharing is discouraged.]
## Acceptance Criteria:
   * [Given a user is authenticated, When they login from another device, Then the previous session is invalidated.]
## Edge Cases:
   * [What happens when a user legitimately needs to switch devices?]
## Traceability:
### Parent:
    * [EP-002]
### Tags:
    * [FR-008, Backend, Security]
### Dependencies:
    * [US_011, US_012]
```
---

## Story ID
   * ID Format: US_014

## Story Title
   * Prevent concurrent sessions from same user

## Description
  * As a security officer, I want to prevent concurrent sessions from the same user account, so that credential sharing is discouraged and session hijacking is detectable.

## Acceptance Criteria
  * Given a user is already authenticated with an active session, When they login from another device/browser, Then the previous session is invalidated.
  * Given a session is invalidated due to new login, When the original session makes a request, Then the API returns 401 with a "session invalidated" message.
  * Given concurrent session prevention is active, When a user logs in, Then the system logs the session replacement event in the audit trail.

## Edge Cases
   * What happens when a user legitimately needs to switch devices quickly?
   * How does the system handle race conditions with near-simultaneous logins?
   * What message does the user see when their session is invalidated by another login?

## Traceability
### Parent Epic
    * Epic : EP-002

### Requirement Tags
    * FR-008
    * Backend
    * Security

### Dependencies
    * US_011
    * US_012
