# User Story - US_114

## Quick Reference Schema
```yaml
# User Story:
  * ID: [US_114]
  * Title: [Audit vector queries and delete embeddings with source]
## Description:
   * [As a security officer, I want vector queries audited and embeddings deleted when source documents are deleted.]
## Acceptance Criteria:
   * [Given vector queries, When executed, Then they are logged in audit trail.]
## Edge Cases:
   * [What happens when deletion fails partially?]
## Traceability:
### Parent:
    * [EP-034]
### Tags:
    * [FR-112, FR-113, DR-006, Backend, Security, Audit]
### Dependencies:
    * [US_062, US_101]
```
---

## Story ID
   * ID Format: US_114

## Story Title
   * Audit vector queries and delete embeddings with source

## Description
  * As a security officer, I want vector queries audited and embeddings automatically deleted when source documents are deleted, so that data lifecycle is properly managed.

## Acceptance Criteria
  * Given vector queries, When executed, Then they are logged in the audit trail (FR-112).
  * Given a source document deletion, When processed, Then associated embeddings are also deleted (FR-113).
  * Given deletion, When implemented, Then it follows retention policies (DR-006).
  * Given vector query logs, When stored, Then they include user, patient/document scope, and query metadata.

## Edge Cases
   * What happens when deletion fails partially?
   * How does the system handle orphaned embeddings?
   * What happens when embeddings are referenced by other entities?

## Traceability
### Parent Epic
    * Epic : EP-034

### Requirement Tags
    * FR-112
    * FR-113
    * DR-006
    * Backend
    * Security
    * Audit

### Dependencies
    * US_062
    * US_101
