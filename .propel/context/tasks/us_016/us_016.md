# User Story - US_016

## Quick Reference Schema
```yaml
# User Story:
  * ID: [US_016]
  * Title: [Implement account lockout after failed attempts]
## Description:
   * [As a security officer, I want accounts locked after 5 failed login attempts for 30 minutes, so that brute-force attacks are blocked.]
## Acceptance Criteria:
   * [Given 5 failed login attempts, When a 6th attempt is made, Then the account is locked for 30 minutes.]
## Edge Cases:
   * [What happens when a legitimate user forgets their password?]
## Traceability:
### Parent:
    * [EP-003]
### Tags:
    * [FR-004, UXR-009, Backend, Security]
### Dependencies:
    * [US_011, US_015]
```
---

## Story ID
   * ID Format: US_016

## Story Title
   * Implement account lockout after failed attempts

## Description
  * As a security officer, I want accounts locked after 5 failed login attempts for 30 minutes, so that brute-force attacks against specific accounts are blocked.

## Acceptance Criteria
  * Given a user account, When 5 consecutive failed login attempts occur, Then the account is locked for 30 minutes.
  * Given an account is locked, When a login attempt is made, Then the system returns an error indicating the account is locked with remaining lockout time.
  * Given an account is locked, When 30 minutes pass, Then the account is automatically unlocked.
  * Given an account lockout occurs, When the lockout is triggered, Then an ACCOUNT_LOCKED event is logged in the audit trail.
  * Given an account is locked, When the UI displays the error, Then it shows clear unlock timeframe (UXR-009).

## Edge Cases
   * What happens when a legitimate user forgets their password and triggers lockout?
   * How does the system handle lockout when the user also hits IP rate limits?
   * Can an admin manually unlock an account before the 30-minute period?

## Traceability
### Parent Epic
    * Epic : EP-003

### Requirement Tags
    * FR-004
    * UXR-009
    * Backend
    * Security

### Dependencies
    * US_011
    * US_015
