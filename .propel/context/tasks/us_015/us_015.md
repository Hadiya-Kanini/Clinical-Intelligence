# User Story - US_015

## Quick Reference Schema
```yaml
# User Story:
  * ID: [US_015]
  * Title: [Implement login rate limiting]
## Description:
   * [As a security officer, I want login attempts rate-limited to 5 per minute per IP, so that brute-force attacks are mitigated.]
## Acceptance Criteria:
   * [Given an IP makes 5 login attempts in 1 minute, When a 6th attempt is made, Then HTTP 429 is returned.]
## Edge Cases:
   * [What happens when legitimate users share an IP (NAT)?]
## Traceability:
### Parent:
    * [EP-003]
### Tags:
    * [FR-004, FR-007, TR-003, Backend, Security]
### Dependencies:
    * [US_011]
```
---

## Story ID
   * ID Format: US_015

## Story Title
   * Implement login rate limiting

## Description
  * As a security officer, I want login attempts rate-limited to 5 per minute per IP address, so that brute-force and credential stuffing attacks are mitigated.

## Acceptance Criteria
  * Given an IP address makes login attempts, When 5 attempts are made within 1 minute, Then subsequent attempts return HTTP 429 Too Many Requests.
  * Given rate limit is exceeded, When HTTP 429 is returned, Then the response includes a Retry-After header indicating when to retry.
  * Given rate limiting is active, When the rate limit window expires, Then the IP can attempt login again.
  * Given a rate limit event occurs, When the limit is exceeded, Then the event is logged in the audit trail (RATE_LIMIT_EXCEEDED).

## Edge Cases
   * What happens when legitimate users share an IP address (corporate NAT, VPN)?
   * How does the system handle distributed attacks from multiple IPs?
   * What happens when the rate limit storage (Redis/memory) is unavailable?

## Traceability
### Parent Epic
    * Epic : EP-003

### Requirement Tags
    * FR-004
    * FR-007
    * TR-003
    * Backend
    * Security

### Dependencies
    * US_011
