# User Story - US_064

## Quick Reference Schema
```yaml
# User Story:
  * ID: [US_064]
  * Title: [Extract entities using single LLM call]
## Description:
   * [As a platform engineer, I want all entity categories extracted in a single LLM call, so that processing is efficient.]
## Acceptance Criteria:
   * [Given retrieved chunks, When extraction runs, Then all categories are extracted in one Gemini call.]
## Edge Cases:
   * [What happens when LLM response is malformed?]
## Traceability:
### Parent:
    * [EP-017]
### Tags:
    * [FR-037, TR-006, AIWorker, RAG]
### Dependencies:
    * [US_063]
```
---

## Story ID
   * ID Format: US_064

## Story Title
   * Extract entities using single LLM call

## Description
  * As a platform engineer, I want all entity categories extracted in a single LLM call using Gemini 2.5 Flash, so that processing is efficient and consistent.

## Acceptance Criteria
  * Given retrieved chunks, When extraction runs, Then all core entity categories are extracted in one Gemini call (FR-037, TR-006).
  * Given the extraction prompt, When designed, Then it includes structured output format for all categories.
  * Given extraction, When performed, Then conflict detection is included in the output (TR-006).
  * Given LLM response, When received, Then it is parsed into structured entity objects.

## Edge Cases
   * What happens when LLM response is malformed or incomplete?
   * How does the system handle LLM rate limits during extraction?
   * What happens when the context is too long for the model?

## Traceability
### Parent Epic
    * Epic : EP-017

### Requirement Tags
    * FR-037
    * TR-006
    * AIWorker
    * RAG

### Dependencies
    * US_063
