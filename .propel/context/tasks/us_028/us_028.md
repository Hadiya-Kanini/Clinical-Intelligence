# User Story - US_028

## Quick Reference Schema
```yaml
# User Story:
  * ID: [US_028]
  * Title: [Implement password reset rate limiting]
## Description:
   * [As a security officer, I want password reset requests rate-limited to 3 per hour per IP, so that abuse is prevented.]
## Acceptance Criteria:
   * [Given 3 reset requests in 1 hour, When a 4th is made, Then HTTP 429 is returned.]
## Edge Cases:
   * [What happens when legitimate users share an IP?]
## Traceability:
### Parent:
    * [EP-006]
### Tags:
    * [FR-006, FR-007, TR-003, Backend, Security]
### Dependencies:
    * [US_024]
```
---

## Story ID
   * ID Format: US_028

## Story Title
   * Implement password reset rate limiting

## Description
  * As a security officer, I want password reset requests rate-limited to 3 per hour per IP, so that abuse and enumeration attacks are prevented.

## Acceptance Criteria
  * Given an IP makes password reset requests, When 3 requests are made within 1 hour, Then subsequent requests return HTTP 429.
  * Given rate limit is exceeded, When HTTP 429 is returned, Then the response includes Retry-After header.
  * Given rate limiting, When triggered, Then the event is logged (RATE_LIMIT_EXCEEDED).
  * Given the UI, When rate limit is hit, Then it displays the retry timeframe (UXR-010).

## Edge Cases
   * What happens when legitimate users share an IP (corporate network)?
   * How does the system handle distributed reset abuse from multiple IPs?
   * What happens when rate limit storage is unavailable?

## Traceability
### Parent Epic
    * Epic : EP-006

### Requirement Tags
    * FR-006
    * FR-007
    * TR-003
    * Backend
    * Security

### Dependencies
    * US_024
