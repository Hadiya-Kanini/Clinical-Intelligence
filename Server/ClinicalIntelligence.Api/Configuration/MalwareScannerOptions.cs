namespace ClinicalIntelligence.Api.Configuration;

/// <summary>
/// Configuration options for malware scanning service.
/// </summary>
public class MalwareScannerOptions
{
    public const string SectionName = "MalwareScanner";

    /// <summary>
    /// Type of scanner to use: "WindowsDefender", "ClamAV", or "None".
    /// </summary>
    public string ScannerType { get; set; } = "WindowsDefender";

    /// <summary>
    /// Path to quarantine infected files.
    /// </summary>
    public string QuarantinePath { get; set; } = "./storage/quarantine";

    /// <summary>
    /// Timeout for scan operations in seconds.
    /// </summary>
    public int ScanTimeoutSeconds { get; set; } = 30;

    /// <summary>
    /// Enable or disable malware scanning.
    /// </summary>
    public bool EnableScanning { get; set; } = true;

    /// <summary>
    /// ClamAV daemon host (for ClamAV scanner).
    /// </summary>
    public string? ClamAvHost { get; set; }

    /// <summary>
    /// ClamAV daemon port (default: 3310).
    /// </summary>
    public int ClamAvPort { get; set; } = 3310;

    /// <summary>
    /// Path to Windows Defender command-line tool (MpCmdRun.exe).
    /// </summary>
    public string WindowsDefenderPath { get; set; } = @"C:\Program Files\Windows Defender\MpCmdRun.exe";

    /// <summary>
    /// Creates options from configuration.
    /// </summary>
    public static MalwareScannerOptions FromConfiguration(IConfiguration configuration)
    {
        var options = new MalwareScannerOptions();
        configuration.GetSection(SectionName).Bind(options);
        return options;
    }
}
